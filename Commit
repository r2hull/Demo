package com.epay.merchant.service;

import com.epay.merchant.model.response.MerchantResponse;
import com.epay.merchant.util.EPayIdentityUtil;
import lombok.RequiredArgsConstructor;
import org.springframework.stereotype.Service;

import java.util.List;

@Service
@RequiredArgsConstructor
public class LogoutService {

    private final TokenService tokenService;

    public MerchantResponse<String> merchantUserLogout(){
        String userName = EPayIdentityUtil.getUserPrincipal().getAuthenticationId();
        int i = tokenService.invalidateUserToken(userName);
        return MerchantResponse.<String>builder().data(List.of("LogOut Successfully")).status(i).build();
    }
}



   public static EPayPrincipal getUserPrincipal() {
       return (EPayPrincipal) SecurityContextHolder.getContext().getAuthentication().getPrincipal();
    }
