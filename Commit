import javax.activation.DataHandler;
import javax.activation.DataSource;
import javax.mail.MessagingException;
import javax.mail.internet.MimeBodyPart;
import javax.mail.internet.MimeMultipart;
import java.io.IOException;
import java.nio.charset.StandardCharsets;

private static final String STATIC_BOUNDARY = "CUSTOM_BOUNDARY_12345"; // Fixed boundary

private MimeMultipart createMultipartResponse(CaptchaResponse captchaResponse, DataSource audioDataSource, RequestType requestType) {
    logger.info("Creating multipart response for RequestId: {}", captchaResponse.getRequestId());

    try {
        // Create MimeMultipart with a fixed boundary
        MimeMultipart mimeMultipart = new MimeMultipart("mixed; boundary=" + STATIC_BOUNDARY);

        // Add JSON Part
        MimeBodyPart jsonPart = new MimeBodyPart();
        jsonPart.setContent(convertToJson(captchaResponse, requestType), "application/json; charset=UTF-8");
        mimeMultipart.addBodyPart(jsonPart);

        // Add Audio File Part
        MimeBodyPart filePart = new MimeBodyPart();
        filePart.setDataHandler(new DataHandler(audioDataSource));
        filePart.setFileName("speech.wav");
        mimeMultipart.addBodyPart(filePart);

        return mimeMultipart;  // No need to rewrite the boundary manually

    } catch (MessagingException | IOException e) {
        logger.error("Error creating multipart response for RequestId: {}", captchaResponse.getRequestId(), e);
        throw new MerchantException(ErrorConstants.GENERATION_ERROR_CODE,
                MessageFormat.format(ErrorConstants.GENERATION_ERROR_MESSAGE, requestType.name()));
    }
}