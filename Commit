package com.epay.reporting.dao;

import com.epay.reporting.dto.ReportMasterDto;
import com.epay.reporting.entity.ReportMaster;
import com.epay.reporting.exception.ReportingException;
import com.epay.reporting.mapper.ReportMasterMapper;
import com.epay.reporting.repository.ReportMasterRepository;
import com.epay.reporting.util.ErrorConstants;
import com.epay.reporting.util.enums.Report;
import com.sbi.epay.logging.utility.LoggerFactoryUtility;
import com.sbi.epay.logging.utility.LoggerUtility;
import lombok.RequiredArgsConstructor;
import org.springframework.stereotype.Component;

import java.text.MessageFormat;
import java.util.List;
import java.util.UUID;

/**
 * Class Name: ReportMasterDao
 * *
 * Description:
 * *
 * Author: V1018344
 * Copyright (c) 2025 [State Bank of India]
 * ALl rights reserved
 * *
 * Version: 1.0
 */

@Component
@RequiredArgsConstructor
public class ReportMasterDao {

    private final LoggerUtility log = LoggerFactoryUtility.getLogger(this.getClass());

    private final ReportMasterRepository reportMasterRepository;
    private final ReportMasterMapper reportMasterMapper;

    /**
     * Find Report List
     *
     * @return List Report
     * Description -Finding ReportList
     **/
    public List<ReportMasterDto> getAllReportNames() {
        log.info("Finding Report List");
        return reportMasterMapper.mapEntityListToDtoList(reportMasterRepository.findAll());
    }

    public UUID getReportIdByName(Report name){
        ReportMaster reportMaster = reportMasterRepository.findByName(name).orElseThrow(() ->
                new ReportingException(ErrorConstants.NOT_FOUND_ERROR_CODE, MessageFormat.format(ErrorConstants.NOT_FOUND_ERROR_MESSAGE, "Report")));
        return reportMaster.getId();
    }

    public Report getReportNameById(UUID reportId){
        ReportMaster reportMaster = reportMasterRepository.findById(reportId).orElseThrow(() ->
                new ReportingException(ErrorConstants.NOT_FOUND_ERROR_CODE, MessageFormat.format(ErrorConstants.NOT_FOUND_ERROR_MESSAGE, "Report")));
        return reportMaster.getName();
    }

}
