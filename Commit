import javax.speech.Central;
import javax.speech.synthesis.Synthesizer;
import javax.speech.synthesis.SynthesizerModeDesc;
import java.io.ByteArrayOutputStream;
import java.util.Locale;

public class SpeechUtil {

    public static byte[] textToSpeech(String text) {
        try {
            Synthesizer synthesizer = Central.createSynthesizer(new SynthesizerModeDesc(Locale.US));
            synthesizer.allocate();
            synthesizer.resume();

            ByteArrayOutputStream outputStream = new ByteArrayOutputStream();
            System.setOut(new java.io.PrintStream(outputStream)); // Redirect output

            synthesizer.speakPlainText(text, null);
            synthesizer.waitEngineState(Synthesizer.QUEUE_EMPTY);

            synthesizer.deallocate();
            return outputStream.toByteArray();

        } catch (Exception e) {
            e.printStackTrace();
            return null;
        }
    }
}