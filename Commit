Fix: Secured file handling to prevent path traversal