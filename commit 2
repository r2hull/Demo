@Repository
public interface ReconFileRepository extends JpaRepository<ReconFileEntity, String> {

    @Modifying
    @Transactional
    @Query(value = """
        INSERT INTO RECON_FILE_DTLS_HISTORY (
            RFD_ID, RFS_ID, MERCHANT_ID, ROW_NUMBER, RECORD_TYPE, ATRN_NUM,
            PAYMENT_AMOUNT, PAYMENT_DATE, BANK_REF_NUMBER, PAYMENT_STATUS,
            RECON_STATUS, SETTLEMENT_STATUS, REMARK,
            CREATED_DATE, CREATED_BY, UPDATED_DATE, UPDATED_BY
        )
        SELECT
            RFD_ID, RFS_ID, MERCHANT_ID, ROW_NUMBER, RECORD_TYPE, ATRN_NUM,
            PAYMENT_AMOUNT, PAYMENT_DATE, BANK_REF_NUMBER, PAYMENT_STATUS,
            RECON_STATUS, SETTLEMENT_STATUS, REMARK,
            CREATED_DATE, CREATED_BY, UPDATED_DATE, UPDATED_BY
        FROM RECON_FILE_DTLS
        WHERE RECON_STATUS IN ('MATCHED', 'UNMATCHED', 'DUPLICATE')
        """, nativeQuery = true)
    int insertReconDetailsToHistory();

    @Modifying
    @Transactional
    @Query(value = """
        DELETE FROM RECON_FILE_DTLS
        WHERE RECON_STATUS IN ('MATCHED', 'UNMATCHED', 'DUPLICATE')
        """, nativeQuery = true)
    int deleteReconDetailsFromMain();
}