@Modifying
@Transactional
@Query(value = """
    BEGIN
        INSERT INTO RECON_FILE_DTLS_HISTORY (
            RFD_ID, RFS_ID, ROW_NUMBER, RECORD_TYPE, ATRN_NUM,
            PAYMENT_AMOUNT, PAYMENT_DATE, BANK_REF_NUMBER, PAYMENT_STATUS,
            RECON_STATUS, SETTLEMENT_STATUS, REMARK
        )
        SELECT
            RFD_ID, RFS_ID, ROW_NUMBER, RECORD_TYPE, ATRN_NUM,
            PAYMENT_AMOUNT, PAYMENT_DATE, BANK_REF_NUMBER, PAYMENT_STATUS,
            RECON_STATUS, SETTLEMENT_STATUS, REMARK
        FROM RECON_FILE_DTLS
        WHERE RECON_STATUS = 'PENDING';

        DELETE FROM RECON_FILE_DTLS
        WHERE RECON_STATUS = 'PENDING';
    END;
    """, nativeQuery = true)
void archiveAndDelete();