    @Query(value = "SELECT * FROM (SELECT M.*,ROW_NUMBER () OVER (PARTITION BY  m.id ORDER BY m.id ) R FROM merchant_user m, merchant_entity_user  meu, merchant_entity_group meg " +
            "WHERE m.id = meu.user_id AND ( ( meu.mid = :mid AND meu.entity_id IS NULL ) OR ( meg.entity_id = meu.entity_id AND meg.mid = :mid )))" +
            "WHERE R=1 order by USER_NAME :sort ", nativeQuery = true)
    List<MerchantUser> findBymId(@Param("mid") String mId, @Param("sort") String sort);



public Page<MerchantUserDto> getAllMerchantUsersByMId(String mId,Pageable pageable) {
        String sort = pageable.getSort().get().findFirst().get().getDirection().name();
        List<MerchantUserDto> merchantUserDtoStream = merchantUserRepository.findBymId(mId,sort).stream().map(this::convertEntityToDTO).toList();
        int total = merchantUserDtoStream.size();
        int start = Math.toIntExact(pageable.getOffset());
        int end = Math.min(start + pageable.getPageSize(), total);
        List<MerchantUserDto> pagedList = (start <= end) ? merchantUserDtoStream.subList(start, end) : Collections.emptyList();
        return new PageImpl<>(pagedList, pageable, total);
    }



JDBC exception executing SQL [SELECT * FROM (SELECT M.*,ROW_NUMBER () OVER (PARTITION BY  m.id ORDER BY m.id ) R FROM merchant_user m, merchant_entity_user  meu, merchant_entity_group meg WHERE m.id = meu.user_id AND ( ( meu.mid = ? AND meu.entity_id IS NULL ) OR ( meg.entity_id = meu.entity_id AND meg.mid = ? )))WHERE R=1 order by USER_NAME ? ] [ORA-00933: SQL command not properly ended

https://docs.oracle.com/error-help/db/ora-00933/] [n/a]; SQL [n/a]
