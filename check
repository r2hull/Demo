BEGIN
    -- 1️⃣ History table me insert karo (MATCHED & PENDING)
    INSERT INTO RECON_FILE_DTLS_HISTORY (
        RFD_ID,
        RF_ID,
        MERCHANT_ID,
        ROW_NUMBER,
        ATRN_NUM,
        TXN_AMOUNT,
        BANK_REF_NUMBER,
        RECON_STATUS,
        SETTLEMENT_STATUS,
        PAYOUT_STATUS,
        REMARK,
        CREATED_DATE,
        UPDATED_DATE
    )
    SELECT
        RFD_ID,
        RF_ID,
        MERCHANT_ID,
        ROW_NUMBER,
        ATRN_NUM,
        TXN_AMOUNT,
        BANK_REF_NUMBER,
        RECON_STATUS,
        SETTLEMENT_STATUS,
        PAYOUT_STATUS,
        REMARK,
        CREATED_DATE,
        UPDATED_DATE
    FROM RECON_FILE_DTLS
    WHERE RECON_STATUS IN ('MATCHED', 'PENDING');

    -- 2️⃣ Main table se delete karo (MATCHED & PENDING)
    DELETE FROM RECON_FILE_DTLS
    WHERE RECON_STATUS IN ('MATCHED', 'PENDING');

    COMMIT;
END;
/